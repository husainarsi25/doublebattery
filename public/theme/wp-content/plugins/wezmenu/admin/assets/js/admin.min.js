!function(e){"use strict";var n={initialize:function(){n.add_wezmenu_to_wpmenu(),n.event(),n.scroll_panel_right(!0),n.process_media()},add_wezmenu_to_wpmenu:function(){e("ul.menu > li.menu-item").each(function(){var n=parseInt(e(this).attr("id").replace("menu-item-",""),10);e("> .menu-item-bar > .menu-item-handle > span.item-title > span.menu-item-title",this).append('<span class="wezmenu-item-config" data-id="'+n+'"><i class="fa fa-cogs"></i> WEZMENU <i class="fa fa-warning"></i></span>')}),e("ul.menu > li.menu-item .wezmenu-item-config").click(function(){var a=parseInt(e(this).attr("data-id"),10);n.open_wezmenu_panel(a)})},open_wezmenu_panel:function(a){if(!e(".wezmenu-header .wezmenu-config-panel-save > i").hasClass("fa-spinner")){e(".wezmenu-config-panel-wrapper").attr("data-id",a);var i=wezmenu_menu_item_data[a];1==i["nosave-change"]?e(".wezmenu-header .wezmenu-config-panel-save i").attr("class","fa fa-warning"):e(".wezmenu-header .wezmenu-config-panel-save i").attr("class","fa fa-save"),e(".wezmenu-header > h2 > span").html(i["general-title"]);for(var t in i){var r=e("#wezmenu_config_"+t);r.length>0&&(r.hasClass("wez-checkbox")?r.prop("checked",i[t]==r.val()):r.val(i[t]),r.hasClass("wez-icon")&&e("> i",e(r).parent()).attr("class","fa "+i[t])),r.hasClass("wez-color-picker")&&e(".wp-color-result",r.parent().parent()).css("background-color",i[t])}"custom"!=i["nosave-type"]?e("#wezmenu_config_general-url").attr("readonly",""):e("#wezmenu_config_general-url").removeAttr("readonly"),e(".wezmenu-config-panel-wrapper").hasClass("in")||n.show_wezmenu_panel()}},show_wezmenu_panel:function(){e(".wezmenu-config-panel-wrapper").addClass("in")},hide_wezmenu_panel:function(){e(".wezmenu-icon-popup").fadeOut(),e(".wezmenu-config-panel-wrapper").removeClass("in")},event:function(){n.rel_section_click(),n.wezmenu_config_panel_close_click(),n.wezmenu_icon_popup_event(),n.wp_color_picker(),n.wp_input_change(),n.window_keyup(),n.save_config_panel(),n.reset()},reset:function(){e(".wezmenu-config-panel-wrapper li.wez-reset").click(function(){var n=e(".wezmenu-config-panel-wrapper").attr("data-id");e("> i",this).attr("class","fa fa-spinner fa-spin");var a=wezmenu_menu_item_data[n];for(var i in wezmenu_menu_item_default)0!==i.indexOf("nosave-")&&0!==i.indexOf("general-")&&(a[i]=wezmenu_menu_item_default[i]);for(var i in a){var t=e("#wezmenu_config_"+i);t.length>0&&(t.hasClass("wez-checkbox")?t.prop("checked",a[i]==t.val()):t.val(a[i]),t.hasClass("wez-icon")&&e("> i",e(t).parent()).attr("class","fa "+a[i])),t.hasClass("wez-color-picker")&&e(".wp-color-result",t.parent().parent()).css("background-color",a[i])}e("> i",this).attr("class","fa fa-refresh"),e(".wezmenu-header .wezmenu-config-panel-save i").attr("class","fa fa-warning"),e('span.menu-item-title .wezmenu-item-config[data-id="'+n+'"]').addClass("is-change")})},save_config_panel:function(){e(".wezmenu-header .wezmenu-config-panel-save").click(function(){if(!e(".wezmenu-header .wezmenu-config-panel-save > i").hasClass("fa-spinner")){e("> i",this).attr("class","fa fa-spinner fa-spin"),e(".wezmenu-config-panel-right").addClass("wezmenu-saving");var n=e(".wezmenu-config-panel-wrapper").attr("data-id"),a={id:n,config:wezmenu_menu_item_data[n],action:"wezmenu_save_config"},i=e(this);e.ajax({url:wezmenu_meta.ajax_url,type:"POST",data:a,dataType:"json",success:function(a){return e(".wezmenu-config-panel-right").removeClass("wezmenu-saving"),a.code<0?(e("> i",i).attr("class","fa fa-save"),void alert(a.message)):(wezmenu_menu_item_data[n]["nosave-change"]=0,e('span.menu-item-title .wezmenu-item-config[data-id="'+n+'"]').removeClass("is-change"),e("> i",i).attr("class","fa fa-check"),"custom"==wezmenu_menu_item_data[n]["nosave-type"]&&e("#edit-menu-item-url-"+n).val(wezmenu_menu_item_data[n]["general-url"]),e("#edit-menu-item-title-"+n).val(wezmenu_menu_item_data[n]["general-title"]),e("#edit-menu-item-attr-title-"+n).val(wezmenu_menu_item_data[n]["general-attr-title"]),e("#edit-menu-item-classes-"+n).val(wezmenu_menu_item_data[n]["general-classes"]),e("#edit-menu-item-xfn-"+n).val(wezmenu_menu_item_data[n]["general-xfn"]),e("#edit-menu-item-description-"+n).val(wezmenu_menu_item_data[n]["general-description"]),void e("#edit-menu-item-target-"+n).prop("checked",wezmenu_menu_item_data[n]["general-target"]==e("#edit-menu-item-target-"+n).val()))},error:function(n){e(".wezmenu-config-panel-right").removeClass("wezmenu-saving"),e("> i",i).attr("class","fa fa-warning")}})}})},wezmenu_config_panel_close_click:function(){e(".wezmenu-header > h2 .wezmenu-config-panel-close").click(function(){n.hide_wezmenu_panel()})},window_keyup:function(){e(window).keyup(function(a){var i=a.keyCode?a.keyCode:a.which;if(27==i)if(e(".wezmenu-config-panel-wrapper").hasClass("in"))n.hide_wezmenu_panel();else{var t=e(".wezmenu-config-panel-wrapper").attr("data-id");"undefined"!=typeof t&&n.show_wezmenu_panel()}})},wp_input_change:function(){e(".wez-input").change(function(){n.process_input_change(this)})},wp_color_picker:function(){e(".wezmenu-config-panel-wrapper").find(".wez-color-picker").wpColorPicker({change:function(e,a,i){setTimeout(function(){n.process_input_change(e.target)},200)},clear:function(a,i,t){setTimeout(function(){n.process_input_change(e(".wez-input",e(a.target).parent())[0])},200)}})},process_input_change:function(n){var a=e(".wezmenu-config-panel-wrapper").attr("data-id");wezmenu_menu_item_data[a]["nosave-change"]=1,e(".wezmenu-header .wezmenu-config-panel-save i").attr("class","fa fa-warning"),e('span.menu-item-title .wezmenu-item-config[data-id="'+a+'"]').addClass("is-change");var i=e(n).attr("name");e(n).hasClass("wez-checkbox")?wezmenu_menu_item_data[a][i]=e(n).prop("checked")?e(n).val():"":wezmenu_menu_item_data[a][i]=e(n).val()},scroll_panel_right:function(n){var a=e(".wezmenu-config-panel-right-inner").outerHeight(),i=e(".wezmenu-config-panel-right").height(),t=e(".wezmenu-panel-scroll-wrapper").height()-2;e(".wezmenu-config-panel-right-inner").css("top","0"),a>i?(e(".wezmenu-config-panel-right").addClass("show-scroll"),e(".wezmenu-panel-drag").height(1*i/a*t+"px"),e(".wezmenu-panel-drag").css("top","0")):e(".wezmenu-config-panel-right").removeClass("show-scroll"),n&&(e(".wezmenu-panel-drag").draggable({axis:"y",containment:"parent",drag:function(){var n=e(".wezmenu-config-panel-right-inner").outerHeight(),a=e(".wezmenu-config-panel-right").height(),i=e(".wezmenu-panel-scroll-wrapper").height()-2,t=e(".wezmenu-panel-drag").position().top,r=e(".wezmenu-panel-drag").height(),o=(a-n)*t*1/(i-r);e(".wezmenu-config-panel-right-inner").css("top",o+"px")}}),e(".wezmenu-config-panel-right").mousewheel(function(n,a){if(e(".wezmenu-config-panel-right").hasClass("show-scroll")){n.preventDefault();var i=e(".wezmenu-config-panel-right-inner").outerHeight(),t=e(".wezmenu-config-panel-right").height(),r=e(".wezmenu-panel-scroll-wrapper").height()-2,o=e(".wezmenu-panel-drag").position().top,c=e(".wezmenu-panel-drag").height();o-=10*a,0>o&&(o=0),o>r-c&&(o=r-c),e(".wezmenu-panel-drag").css("top",o+"px");var p=(t-i)*o*1/(r-c);e(".wezmenu-config-panel-right-inner").css("top",p+"px")}}))},rel_section_click:function(){e(".wezmenu-config-panel-left > ul > li[rel-section]").click(function(){e(".wezmenu-config-panel-right-inner > section").removeClass("active");var a=e(this).attr("rel-section");e("section#"+a).addClass("active"),e(".wezmenu-config-panel-left > ul > li[rel-section]").removeClass("active"),e(this).addClass("active"),n.scroll_panel_right(!1)})},process_media:function(){wezmenu_media_init(".wez-media-image",".wez-media-button",null,function(a,i){e(a).val()!=i&&n.process_input_change(a)})},wezmenu_icon_popup_event:function(){e(".wez-icon-wrapper").click(function(n){if(1!=e(n.target).closest(".wez-icon-remove").length){var a=e(".wezmenu-config-panel-right").position().top+e(".wezmenu-config-panel-right-inner").position().top+jQuery(this).position().top,i=e(".wezmenu-config-panel-right").position().left+e(".wezmenu-config-panel-right-inner").position().left+jQuery(this).position().left+jQuery(this).outerWidth(),t=e(this).attr("data-rel");e(".wezmenu-icon-popup").attr("data-rel",t),e(".wezmenu-icon-popup").css("top",a+"px"),e(".wezmenu-icon-popup").css("left",i+"px"),e("li",".wezmenu-icon-popup-content").show(),e(".wezmenu-icon-popup-header > input").val(""),e(".wezmenu-icon-popup").fadeIn()}}),e(".wezmenu-icon-popup-header > i.fa-remove").click(function(){e(".wezmenu-icon-popup").fadeOut()}),e(".wezmenu-icon-popup-content > ul > li").click(function(){var a=e("i",this).attr("class").replace("fa ",""),i=e(".wezmenu-icon-popup").attr("data-rel");e('.wez-icon-wrapper[data-rel="'+i+'"] > i').attr("class","fa "+a);var t=e('.wez-icon-wrapper[data-rel="'+i+'"] > input').val();e('.wez-icon-wrapper[data-rel="'+i+'"] > input').val(a),t!=a&&n.process_input_change(e('.wez-icon-wrapper[data-rel="'+i+'"] > input')),e(".wezmenu-icon-popup").fadeOut()}),e(".wez-icon-remove").click(function(){""!=e("> input",e(this).parent()).val()&&(e("> input",e(this).parent()).val(""),e("> i",e(this).parent()).attr("class",""),n.process_input_change(e("> input",e(this).parent())))}),e(".wezmenu-icon-popup .wezmenu-icon-remove").click(function(){var a=e(".wezmenu-icon-popup").attr("data-rel");e('.wez-icon-wrapper[data-rel="'+a+'"] > i').attr("class",""),""!=e('.wez-icon-wrapper[data-rel="'+a+'"] > input').val()&&n.process_input_change(e('.wez-icon-wrapper[data-rel="'+a+'"] > input')),e('.wez-icon-wrapper[data-rel="'+a+'"] > input').val(""),e(".wezmenu-icon-popup").fadeOut()}),e(".wezmenu-icon-popup-header > input").keyup(function(){var n=e(this).val();e("li",".wezmenu-icon-popup-content").each(function(){e(this).attr("title").search(new RegExp(n,"i"))<0?e(this).hide():e(this).show()})})}};e(document).ready(function(){n.initialize()})}(jQuery);